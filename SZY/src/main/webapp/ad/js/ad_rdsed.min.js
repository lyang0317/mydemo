var AJAXFALSE='<tr><td colspan="10">数据异常，请稍后<a href="javascript:;" onclick="location.reload();return false;">重试</a></td></tr>',AJAXFERROR='<tr><td colspan="10">数据链接异常，请稍后<a href="javascript:;" onclick="location.reload();return false;">重试</a></td></tr>';
var RDSED_AJAX_DATA={size:7,number:1,state:-1,account_email:"",account_name:""};$(function(){getAllSpace();searchKeyChange();$("#J_adSchValue").keydown(function(a){if(a.keyCode==13){spaceSearch();
}});});function getAllSpace(b){var a=$("#J_rdsSpaceTbody");if(b){RDSED_AJAX_DATA.number=b;}$.ajax({url:AJAXURL.allByCondition,data:RDSED_AJAX_DATA,type:"POST",dataType:"JSON",beforeSend:function(){a.html('<tr><td colspan="10"><i class="load-one">拼命加载中...</i></td></tr>');
},success:function(c){if(c.state){a.html(createSpaceListHtml(c.data.list));if(c.data.list.length>0){new PAGE("J_comPage",RDSED_AJAX_DATA.number,c.data.totalPage,getAllSpace);
}}else{a.html(AJAXFALSE);}},error:function(){a.html(AJAXFERROR);}});}function createSpaceListHtml(f){if(f){var c=[],a=f.length;if(a>0){for(var b=0;b<a;
b++){var e=f[b],d=e.state;c.push("<tr>");c.push('<td><a href="rdseddetail?spid='+e.id+'" title="详情" target="_blank">'+e.name+"</a></td>");c.push("<td>"+e.rest_store+"GB/<strong>"+e.storage+"GB</strong></td>");
c.push("<td>"+e.rest_conn+"/<strong>"+e.max_conn+"个</strong></td>");var g=getSpaceState(e.state);c.push("<td>"+g+"</td>");c.push("<td>"+e.cdate+"</td>");
c.push("<td>"+e.edate+"</td>");c.push("<td>"+e.email+"</td>");c.push("<td>"+e.realname+"</td>");if(e.remarks==""){c.push('<td><a href="javascript:void(0);" data-toggle="modal" data-target="#editRemark" onclick="editRemark('+e.id+');return false;">编辑</a></td>');
}else{c.push('<td><span id="J_rdsedRemarks_'+e.id+'">'+e.remarks+'</span>   <a href="javascript:void(0);" data-toggle="modal" data-target="#editRemark" onclick="editRemark('+e.id+');return false;">编辑</a></td>');
}if(d==0){c.push('<td><a class="switch-btn off" href="javascript:void(0);" data-toggle="modal" data-target="#onAndOffSpace" onclick="onAndOffSpace('+e.id+","+d+');" title="关闭"></a></td>');
}else{if(d==2){c.push('<td><a class="switch-btn on" href="javascript:void(0);" data-toggle="modal" data-target="#onAndOffSpace" onclick="onAndOffSpace('+e.id+","+d+');" title="启用"></a></td>');
}else{c.push("<td>&nbsp;</td>");}}c.push("</tr>");}}else{c.push('<tr><td colspan="9">没有查找到相关条件的结果</td></tr>');$("#J_comPage").html("");}return c.join("");
}}function spaceStateChange(a){RDSED_AJAX_DATA.state=a;getAllSpace();}function spaceSearch(){var a=$("#J_adSchValue").val(),b=$("#J_adSchKey").attr("data-key");
if(b=="email"){RDSED_AJAX_DATA.account_email=a;RDSED_AJAX_DATA.account_name=="";}else{if(b="realname"){RDSED_AJAX_DATA.account_email="";RDSED_AJAX_DATA.account_name=a;
}}getAllSpace();}function editRemark(b){var a=$("#J_rdsedRemarks_"+b).text();$("#J_editRemarkText").val(a);$("#J_sureEditRemark").on("click",function(){var c=$.trim($("#J_editRemarkText").val()),d=$("#J_editRemarkError");
if(c.length>20){d.removeClass("none").html("备注信息不能多余20字");return false;}$.ajax({url:AJAXURL.editSpRemark,data:{id:b,remarks:c},type:"POST",dataType:"JSON",success:function(e){if(e.state){alert("备注添加成功，确定后将刷新页面！");
location.reload();}else{alert("数据异常，请稍后再试");}},error:function(){alert("链接异常，请稍后再试");}});});}function searchKeyChange(){var d=$("#J_adSchKeyList a"),c=d.length,b=$("#J_adSchKey");
for(var a=0;a<c;a++){d[a]._i=a;d[a].onclick=function(){var f=this,e=b.attr("data-key");dataKey=$(f).attr("data-key"),key=$(f).html();b.attr("data-key",dataKey);
b.html(key);};}}function onAndOffSpace(a,c){new vfCode("J_vfCodeImg","J_vfCodeChange","onAndOffSpace");var b="";if(c==0){$("#J_rdsedDelTitle").html("关闭空间");
$("#J_rdsedDelCont").html("确定关闭空间吗？");b=AJAXURL.spaceForbid;}else{if(c==2){$("#J_rdsedDelTitle").html("启用空间");$("#J_rdsedDelCont").html("确定启用空间吗？");b=AJAXURL.spaceRecovery;
}}$("#J_submitDelSpace").on("click",function(){var d=$.trim($("#J_rdsedDelYzm").val());if(!RE.NULL.test(d)){alert("请输入验证码");return false;}if(!/^[a-zA-Z0-9]{6}$/.test(d)){alert("验证码不正确");
return false;}$.ajax({url:b,data:{id:a,input:d,captcha:"delAdmin"},type:"POST",dataType:"JSON",success:function(e){if(e.state){location.reload();}else{alert("数据异常，请稍后再试！");
new vfCode("J_vfCodeImg","J_vfCodeChange","onAndOffSpace");}},error:function(){alert("链接异常，请稍后再试！");}});});}