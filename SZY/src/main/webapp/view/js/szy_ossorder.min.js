var OSS_AJAX_DATA={size:7,number:1,index:0,condition:0};$(function(){getAllOrder();});function getAllOrder(b){$("#J_comPage").html("");if(b){OSS_AJAX_DATA.number=b;
}var a=$("#J_ossTbBody");$.ajax({url:AJAXURL.queryByState,data:OSS_AJAX_DATA,type:"POST",dataType:"JSON",beforeSend:function(){a.html('<i class="load-one">拼命加载中...</i>');
},success:function(c){if(c.state){a.html(createOrderListHtml(c.data.list));if(c.data.list.length>0){new PAGE("J_comPage",OSS_AJAX_DATA.number,c.data.totalPage,getAllOrder);
}else{$("#J_comPage").html("");}}else{a.html('数据异常，请稍后<a href="javascript:;" onclick="location.reload();return false;">重试</a>');}},error:function(){a.html('链接异常，请稍后<a href="javascript:;" onclick="location.reload();return false;">重试</a>');
}});}function createOrderListHtml(e){if(e){var d=[],b=e.length;if(b>0){for(var c=0;c<b;c++){var a=e[c],g=getPayStateName(a.pay_state);d.push('<div class="panel-list panel panel-default">');
d.push('<div class="panel-heading">');d.push('<h3 class="pull-left panel-title">订单号：<span>'+a.order_num+'</span>  <a class="more" href="ossorderdetail?ordernum='+a.order_num+'" target="_blank" title="详情>>">详情>></a></h3>');
d.push("</div>");d.push('<div class="panel-body">');d.push('<table class="tb-bd table" width="100%">');d.push("<tr>");d.push('<td width="18%">'+a.goods_name+"</td>");
d.push('<td width="22%"><div class="line">'+a.user_email+"</div></td>");d.push('<td width="15%"><div class="line">'+a.order_time+"</div></td>");d.push('<td width="15%"><div class="line">'+g+"</div></td>");
d.push('<td width="15%"><div class="line price">￥'+a.price+"</div></td>");d.push('<td><div class="line">');if(a.user_operate==0){if(a.check_state==0){d.push('<a href="javascript:;" onclick="denyOrder(\''+a.order_num+"');return false;\">取消</a>");
}else{var f=getOrderCheckState(a.check_state);d.push(f);}}else{d.push("已取消");}d.push("</div></td>");d.push("</tr>");d.push("</table>");d.push("</div>");
d.push("</div>");}}else{d.push('<div class="tc mt20">没有查找到相关条件的结果</div>');}return d.join("");}}function orderStateChange(a){var b=a.split("-");OSS_AJAX_DATA.number=1;
OSS_AJAX_DATA.index=b[0];OSS_AJAX_DATA.condition=b[1];getAllOrder();}function denyOrder(a){if(a){ALERT.init({info:"确定取消吗？",callback:function(){$.ajax({url:AJAXURL.cancelByid,data:{id:a},type:"POST",dataType:"JSON",success:function(b){if(b.state){location.reload();
}else{alert("操作失败，请稍后再试");}},error:function(){alert("链接异常，请稍后再试");}});}});}}