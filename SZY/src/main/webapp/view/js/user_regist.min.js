var Errors=new Array("验证通过","身份证号码位数不对","身份证号码出生日期超出范围或含有非法字符","身份证号码校验错误","身份证地区非法");function checkIdcard(m){var l={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"xingjiang",71:"台湾",81:"香港",82:"澳门",91:"国外"};
var k,h;var n,j;var i=new Array();i=m.split("");if(l[parseInt(m.substr(0,2))]==null){return Errors[4];}switch(m.length){case 15:if((parseInt(m.substr(6,2))+1900)%4==0||((parseInt(m.substr(6,2))+1900)%100==0&&(parseInt(m.substr(6,2))+1900)%4==0)){ereg=/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}$/;
}else{ereg=/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}$/;
}if(ereg.test(m)){return Errors[0];}else{return Errors[2];}break;case 18:if(parseInt(m.substr(6,4))%4==0||(parseInt(m.substr(6,4))%100==0&&parseInt(m.substr(6,4))%4==0)){ereg=/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/;
}else{ereg=/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}[0-9Xx]$/;
}if(ereg.test(m)){n=(parseInt(i[0])+parseInt(i[10]))*7+(parseInt(i[1])+parseInt(i[11]))*9+(parseInt(i[2])+parseInt(i[12]))*10+(parseInt(i[3])+parseInt(i[13]))*5+(parseInt(i[4])+parseInt(i[14]))*8+(parseInt(i[5])+parseInt(i[15]))*4+(parseInt(i[6])+parseInt(i[16]))*2+parseInt(i[7])*1+parseInt(i[8])*6+parseInt(i[9])*3;
k=n%11;j="F";h="10X98765432";j=h.substr(k,1);if(i[17]=="x"&&j=="X"){j="x";}if(j==i[17]){return Errors[0];}else{return Errors[3];}}else{return Errors[2];
}break;default:return Errors[1];break;}}$(function(){});var _regEmail=$("#J_regEmail"),_regUserName=$("#J_regUserName"),_regName=$("#J_regName"),_regIdCard=$("#J_regIdCard"),_regPhone=$("#J_regPhone"),_regCompany=$("#J_regCompany"),_regPwd=$("#J_regPwd"),_regPwdSure=$("#J_regPwdSure"),_regVerification=$("#J_regVerification"),_errorEmail=$("#J_errorEmail"),_errorUserName=$("#J_errorUserName"),_errorName=$("#J_errorName"),_errorIdCard=$("#J_errorIdCard"),_errorPhone=$("#J_errorPhone"),_errorCompany=$("#J_errorCompany"),_errorPwd=$("#J_errorPwd"),_errorPwdSure=$("#J_errorPwdSure"),_errorVerification=$("#J_errorVerification");
var REGCHECK={EAML:{ABLE:true,FOCUS:function(){_errorEmail.addClass("none");},BLUR:function(c){var a=$.trim(c),b=this;if(!RE.NULL.test(a)){return false;
}if(!RE.EMAIL.test(a)){_errorEmail.removeClass("none").html("邮箱格式不正确");}else{$.ajax({url:AJAXURL.checkEmail,data:{email:a},type:"POST",dataType:"json",success:function(d){if(!d.state){_errorEmail.removeClass("succ").removeClass("none").html("此邮箱已被占用");
b.ABLE=false;}else{_errorEmail.addClass("succ").removeClass("none").html("邮箱可用");b.ABLE=true;}}});}}},USERNAME:{ABLE:true,FOCUS:function(){_errorUserName.addClass("none");
},BLUR:function(c){var a=$.trim(c),b=this;if(!RE.NULL.test(a)){return false;}if(!/^(\w+|[\u4E00-\u9FA5]){5,15}$/.test(a)){_errorUserName.removeClass("none").html("注册用户名由5到15个字组成");
}else{$.ajax({url:AJAXURL.checkUsername,data:{username:a},type:"POST",dataType:"json",success:function(d){if(!d.state){_errorUserName.removeClass("succ").removeClass("none").html("此用户名已被占用");
b.ABLE=false;}else{_errorUserName.addClass("succ").removeClass("none").html("用户名可用");b.ABLE=true;}}});}}},NAME:{ABLE:true,FOCUS:function(){_errorName.addClass("none");
},BLUR:function(c){var a=$.trim(c),b=this;if(!RE.NULL.test(a)){return false;}if(!/^(\w+|[\u4E00-\u9FA5]){2,10}$/.test(a)){_errorName.removeClass("succ").removeClass("none").html("真实姓名由2到10个字组成");
}}},IDCARD:{ABLE:true,FOCUS:function(){_errorIdCard.addClass("none");},BLUR:function(d){var a=$.trim(d),c=this;if(!RE.NULL.test(a)){return false;}var b=checkIdcard(a);
if(b!="验证通过"){_errorIdCard.removeClass("succ").removeClass("none").html(b);return false;}else{$.ajax({url:AJAXURL.checkCard,data:{identitycard:a},type:"POST",dataType:"json",success:function(e){if(!e.state){_errorIdCard.removeClass("succ").removeClass("none").html("此身份证号码已被注册");
c.ABLE=false;}else{_errorIdCard.addClass("succ").removeClass("none").html("身份证号码可用");c.ABLE=true;}}});}}},PHONE:{ABLE:true,FOCUS:function(){_errorPhone.addClass("none");
},BLUR:function(c){var a=$.trim(c),b=this;if(!RE.NULL.test(a)){return false;}if(!RE.PHONE.test(a)){_errorPhone.removeClass("succ").removeClass("none").html("手机号码不正确");
}else{$.ajax({url:AJAXURL.checkTel,data:{tel:a},type:"POST",dataType:"json",success:function(d){if(!d.state){_errorPhone.removeClass("succ").removeClass("none").html("此手机号码已被占用");
b.ABLE=false;}else{_errorPhone.addClass("succ").removeClass("none").html("手机号码可用");b.ABLE=true;}}});}}},COMPANY:{FOCUS:function(){_errorCompany.addClass("none");
},BLUR:function(b){var a=$.trim(b);if(!RE.NULL.test(a)){return false;}if(!/^([a-zA-Z0-9]+|[\u4E00-\u9FA5]){2,20}$/.test(a)){_errorCompany.removeClass("succ").removeClass("none").html("公司名称不正确");
}}},PWD:{FOCUS:function(){_errorPwd.addClass("none");},BLUR:function(b){var a=$.trim(b);if(!RE.NULL.test(a)){$("#J_userPwdLen").addClass("none");$("#J_userPwdLay").css({width:"0px"});
return false;}if(!/^[A-Za-z0-9]{6,20}$/.test(a)){_errorPwd.removeClass("succ").removeClass("none").html("密码由6到20个字符组成");}},KEYUP:function(d){var b=$.trim(d),c=b.length,a=null;
if(!RE.NULL.test(b)){return false;}if(c>5){$("#J_userPwdLen").removeClass("none");a=checkStrong(b);$("#J_userPwdLay").animate({width:100*a+"px"},"slow");
}else{$("#J_userPwdLen").addClass("none");$("#J_userPwdLay").css({width:"0px"});}}},PWDSURE:{FOCUS:function(){_errorPwdSure.addClass("none");},BLUR:function(c){var b=$.trim(c),a=$.trim($("#J_regPwd").val());
if(!RE.NULL.test(b)){return false;}if(a!=b){_errorPwdSure.removeClass("succ").removeClass("none").html("两次输入的密码不一致");}}},VF:{FOCUS:function(){_errorVerification.addClass("none");
},BLUR:function(b){var a=$.trim(b);if(!RE.NULL.test(a)){return false;}if(!/^[a-zA-Z0-9]{6}$/.test(a)){_errorVerification.removeClass("succ").removeClass("none").html("验证码不正确");
}}}};function submitRegInfo(){var d=$.trim(_regEmail.val()),i=$.trim(_regUserName.val()),e=$.trim(_regName.val()),c=$.trim(_regIdCard.val()),b=$.trim(_regPhone.val()),f=$.trim(_regCompany.val()),k=$.trim(_regPwd.val()),j=$.trim(_regPwdSure.val()),h=$.trim(_regVerification.val()),a=$("#J_vfCodeImg").attr("data-kind");
if(!RE.NULL.test(d)){_errorEmail.removeClass("succ").removeClass("none").html("请填写注册邮箱");return false;}else{if(!RE.EMAIL.test(d)){_errorEmail.removeClass("succ").removeClass("none").html("邮箱格式不正确");
return false;}}if(!RE.NULL.test(i)){_errorUserName.removeClass("succ").removeClass("none").html("请填写注册用户名");return false;}else{if(!/^(\w+|[\u4E00-\u9FA5]){5,15}$/.test(i)){_errorUserName.removeClass("succ").removeClass("none").html("注册用户名由5到15个字组成");
return false;}}if(!RE.NULL.test(e)){_errorName.removeClass("succ").removeClass("none").html("请填写真实姓名");return false;}else{if(!/^(\w+|[\u4E00-\u9FA5]){2,10}$/.test(e)){_errorName.removeClass("succ").removeClass("none").html("真实姓名由2到10个字组成");
return false;}}var g=checkIdcard(c);if(!RE.NULL.test(c)){_errorIdCard.removeClass("succ").removeClass("none").html("请填写身份证号码");return false;}else{if(g!="验证通过"){_errorIdCard.removeClass("succ").removeClass("none").html(g);
return false;}}if(!RE.NULL.test(b)){_errorPhone.removeClass("succ").removeClass("none").html("请填写手机号码");return false;}else{if(!RE.PHONE.test(b)){_errorPhone.removeClass("succ").removeClass("none").html("手机号码不正确");
return false;}}if(!RE.NULL.test(f)){_errorCompany.removeClass("succ").removeClass("none").html("请填写公司名称");return false;}else{if(!/^([a-zA-Z0-9]+|[\u4E00-\u9FA5]){2,20}$/.test(f)){_errorCompany.removeClass("succ").removeClass("none").html("公司名称不正确");
}}if(!RE.NULL.test(k)){_errorPwd.removeClass("succ").removeClass("none").html("请填写登录密码");return false;}else{if(!/^[A-Za-z0-9]{6,20}$/.test(k)){_errorPwd.removeClass("succ").removeClass("none").html("登录密码由6到20个字符组成");
return false;}}if(k!=j){_errorPwdSure.removeClass("succ").removeClass("none").html("两次输入的密码不一致");return false;}if(!RE.NULL.test(h)){_errorVerification.removeClass("succ").removeClass("none").html("请输入验证码");
return false;}else{if(!/^[a-zA-Z0-9]{6}$/.test(h)){_errorVerification.removeClass("succ").removeClass("none").html("验证码不正确");return false;}}if(!REGCHECK.EAML.ABLE&&!REGCHECK.USERNAME.ABLE&&!REGCHECK.NAME.ABLE&&!REGCHECK.PHONE.ABLE&&!REGCHECK.IDCARD.ABLE){return false;
}$.ajax({url:AJAXURL.register,data:{email:d,name:i,realname:e,regIdCard:c,tel:b,comname:f,pwd:k,input:h,captcha:a},type:"POST",dataType:"json",success:function(l){if(l.state){location.href="regist_vf?email="+encodeURIComponent(d);
}else{new vfCode("J_vfCodeImg","J_vfCodeChange","register");if(l.msg==null){_errorVerification.removeClass("succ").removeClass("none").html("数据异常，请稍后再试");
}else{_errorVerification.removeClass("succ").removeClass("none").html(l.msg);}}},error:function(){new vfCode("J_vfCodeImg","J_vfCodeChange","register");
_errorVerification.removeClass("succ").removeClass("none").html("链接异常，请稍后再试");}});}